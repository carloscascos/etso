<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OBSERVATORIO ETS - Maritime Intelligence</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}?v=2.0.0">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <div class="app">
        <!-- Compact Header -->
        <header class="header">
            <div class="header-brand">
                <h1>üö¢ OBSERVATORIO ETS</h1>
                <span class="version">v2.0</span>
            </div>
            <div class="header-nav">
                <button class="nav-btn active" data-page="overview">Overview</button>
                <button class="nav-btn" data-page="themes">Themes</button>
                <button class="nav-btn" data-page="details">Details</button>
                <button class="nav-btn" data-page="claims">Claims</button>
            </div>
            <div class="header-info">
                <span id="quarter-selector" class="quarter">Q1 2025</span>
            </div>
        </header>

        <!-- Page: Overview -->
        <div id="page-overview" class="page active">
            <div class="overview-stats">
                <div class="stat-card">
                    <div class="stat-value" id="total-themes">0</div>
                    <div class="stat-label">Research Themes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-claims">0</div>
                    <div class="stat-label">Validated Claims</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avg-confidence">0%</div>
                    <div class="stat-label">Avg Confidence</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="validation-rate">0%</div>
                    <div class="stat-label">Validation Rate</div>
                </div>
            </div>
            
            <div class="overview-content">
                <section class="recent-section">
                    <h2>Recent Research Activity</h2>
                    <div id="recent-activity"></div>
                </section>
            </div>
        </div>

        <!-- Page: Research Themes -->
        <div id="page-themes" class="page">
            <div class="themes-header">
                <h2>Research Themes</h2>
                <button class="btn-primary" onclick="app.showNewThemeDialog()">+ New Theme</button>
            </div>
            <div class="themes-grid" id="themes-list"></div>
        </div>

        <!-- Page: Research Details -->
        <div id="page-details" class="page">
            <div class="details-header">
                <div class="breadcrumb">
                    <span onclick="app.showPage('themes')">Themes</span> / 
                    <span id="detail-title">Select a theme</span>
                </div>
            </div>
            
            <div class="details-layout">
                <div class="research-main">
                    <!-- 1. Research Guidance -->
                    <section class="detail-section">
                        <div class="section-header">
                            <h3>üìã Research Guidance</h3>
                            <button id="run-research-btn" class="btn-primary btn-run" onclick="app.runCurrentResearch()">
                                ‚ñ∂Ô∏è Run Research
                            </button>
                        </div>
                        <div id="research-guidance" class="guidance-content"></div>
                    </section>

                    <!-- 2. Research Results -->
                    <section class="detail-section">
                        <h3>üìä Research Results</h3>
                        <div id="research-results" class="results-content"></div>
                    </section>

                    <!-- 3. References -->
                    <section class="detail-section">
                        <h3>üîó References</h3>
                        <div id="research-references" class="references-content"></div>
                    </section>

                    <!-- 4. Validation Summary -->
                    <section class="detail-section">
                        <h3>‚úÖ Validation Summary</h3>
                        <div id="validation-summary" class="summary-content"></div>
                    </section>
                </div>

                <!-- Claims Sidebar -->
                <div class="claims-sidebar">
                    <h3>üéØ Validation Claims</h3>
                    <div id="claims-list" class="claims-container"></div>
                </div>
            </div>
        </div>

        <!-- Page: Research Claims -->
        <div id="page-claims" class="page">
            <div class="claim-header">
                <div class="breadcrumb">
                    <span onclick="app.showPage('themes')">Themes</span> / 
                    <span onclick="app.showPage('details')">Details</span> / 
                    <span id="claim-title">Claim</span>
                </div>
            </div>
            <div class="claim-content">
                <section class="claim-info">
                    <h3>Claim Text</h3>
                    <div id="claim-text" class="claim-text"></div>
                    
                    <h3>Validation Logic</h3>
                    <textarea id="validation-logic" class="validation-input" 
                              placeholder="Enter validation metaquery..."></textarea>
                    
                    <h3>Generated SQL</h3>
                    <pre id="claim-sql" class="sql-display"></pre>
                    <button class="btn-secondary" onclick="app.regenerateSQL()">Regenerate SQL</button>
                    
                    <h3>Validation Results</h3>
                    <div id="validation-results"></div>
                    
                    <div class="validation-weight">
                        <label>Validation Weight: <span id="weight-value">50</span>%</label>
                        <input type="range" id="weight-slider" min="0" max="100" value="50" 
                               oninput="app.updateWeight(this.value)">
                    </div>
                    
                    <h3>Conclusion</h3>
                    <div id="validation-conclusion"></div>
                    
                    <div class="claim-actions">
                        <button class="btn-primary" onclick="app.saveClaim()">Save Changes</button>
                        <button class="btn-secondary" onclick="app.runValidation()">Run Validation</button>
                    </div>
                </section>
            </div>
        </div>

        <!-- New Theme Dialog -->
        <div id="new-theme-dialog" class="dialog">
            <div class="dialog-content">
                <h3>Create New Research Theme</h3>
                <input type="text" id="new-theme-input" placeholder="Enter research theme...">
                <div class="dialog-actions">
                    <button onclick="app.createTheme()">Create</button>
                    <button onclick="app.closeDialog()">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Edit Theme Dialog -->
        <div id="edit-theme-dialog" class="dialog">
            <div class="dialog-content">
                <h3>Edit Research Theme</h3>
                <label>Title:</label>
                <input type="text" id="edit-theme-title" placeholder="Theme title...">
                <label>Research Guidance:</label>
                <textarea id="edit-theme-input" rows="6" placeholder="Enter research guidance..."></textarea>
                <div class="dialog-actions">
                    <button onclick="app.saveThemeEdit()">Save</button>
                    <button onclick="app.closeDialog()">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Quarter Selector -->
        <div id="quarter-dialog" class="dialog">
            <div class="dialog-content">
                <h3>Select Quarter</h3>
                <div class="quarter-grid">
                    <button data-quarter="Q1 2025">Q1 2025</button>
                    <button data-quarter="Q2 2025">Q2 2025</button>
                    <button data-quarter="Q3 2025">Q3 2025</button>
                    <button data-quarter="Q4 2025">Q4 2025</button>
                    <button data-quarter="Q1 2026">Q1 2026</button>
                    <button data-quarter="Q2 2026">Q2 2026</button>
                    <button data-quarter="Q3 2026">Q3 2026</button>
                    <button data-quarter="Q4 2026">Q4 2026</button>
                    <button data-quarter="Q1 2027">Q1 2027</button>
                    <button data-quarter="Q2 2027">Q2 2027</button>
                    <button data-quarter="Q3 2027">Q3 2027</button>
                    <button data-quarter="Q4 2027">Q4 2027</button>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}?v=2.0.0"></script>
</body>
</html>